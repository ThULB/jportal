<?xml version="1.0" encoding="UTF-8" ?>
<!-- please see http://wiki.apache.org/solr/SchemaXml -->
<schema name="Solr-Schema" version="1.4">

  <types>

    <!-- The StrField type is not analyzed, but indexed/stored verbatim. -->
    <fieldType name="string" class="solr.StrField" sortMissingLast="true" omitNorms="true" />
    <fieldType name="long" class="solr.TrieLongField" precisionStep="0" omitNorms="true" positionIncrementGap="0" />
    <fieldType name="date" class="solr.TrieDateField" omitNorms="true" precisionStep="0" positionIncrementGap="0" />
    <fieldtype name="ignored" stored="false" indexed="false" multiValued="true" class="solr.StrField" />

    <fieldtype name="payloads" stored="false" indexed="true" class="solr.TextField">
      <analyzer>
        <tokenizer class="solr.WhitespaceTokenizerFactory" />
        <!-- The DelimitedPayloadTokenFilter can put payloads on tokens... for example, a token of "foo|1.4" would be indexed as "foo" with a 
          payload of 1.4f Attributes of the DelimitedPayloadTokenFilterFactory : "delimiter" - a one character delimiter. Default is | (pipe) "encoder" 
          - how to encode the following value into a playload float -> org.apache.lucene.analysis.payloads.FloatEncoder, integer -> o.a.l.a.p.IntegerEncoder 
          identity -> o.a.l.a.p.IdentityEncoder Fully Qualified class name implementing PayloadEncoder, Encoder must have a no arg constructor. -->
        <filter class="solr.DelimitedPayloadTokenFilterFactory" delimiter="|" encoder="identity" />
      </analyzer>
    </fieldtype>

    <!-- lowercases the entire field value, keeping it as a single token. -->
    <fieldType name="lowercase" class="solr.TextField" positionIncrementGap="100">
      <analyzer>
        <tokenizer class="solr.KeywordTokenizerFactory" />
        <filter class="solr.LowerCaseFilterFactory" />
      </analyzer>
    </fieldType>

    <fieldType name="text_de" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <tokenizer class="solr.ICUTokenizerFactory" />
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1"
          catenateNumbers="1" catenateAll="0" splitOnCaseChange="1" />
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true" />
        <filter class="solr.ICUFoldingFilterFactory" />
        <filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt" />
        <filter class="solr.SnowballPorterFilterFactory" language="German2" />
        <filter class="solr.RemoveDuplicatesTokenFilterFactory" />
        <filter class="solr.LengthFilterFactory" min="3" max="100" />
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.ICUTokenizerFactory" />
        <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true" />
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="0"
          catenateNumbers="0" catenateAll="0" splitOnCaseChange="1" />
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true" />
        <filter class="solr.ICUFoldingFilterFactory" />
        <filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt" />
        <filter class="solr.SnowballPorterFilterFactory" language="German2" />
        <filter class="solr.RemoveDuplicatesTokenFilterFactory" />
        <filter class="solr.LengthFilterFactory" min="3" max="100" />
      </analyzer>
    </fieldType>
  </types>

  <fields>
    <!-- kind of mcrobjectid, mcrderivateid, fileid -->
    <field name="id" type="string" indexed="true" stored="true" required="true" />
    <field name="objectType" type="string" indexed="true" stored="true" />
    <field name="objectProject" type="string" indexed="true" stored="true" />
    <field name="created" type="date" indexed="true" stored="true" />
    <field name="modified" type="date" indexed="true" stored="true" />

    <!-- parent handling -->
    <field name="parent.href" type="string" indexed="false" stored="false" />
    <field name="parent" type="string" indexed="true" stored="true" />
    <copyField source="parent.href" dest="parent" />

    <!-- MCRObject structure -->
    <field name="derivates" type="string" indexed="true" stored="true" multiValued="true" />
    <field name="derivate.count" type="long" indexed="true" stored="true" />
    <field name="derivate_owner" type="string" stored="true" />

    <!-- ignore all undefined fields -->
    <dynamicField name="*" type="ignored" />

    <!-- MCRDerivate related metadata -->
    <field name="urn" type="string" stored="true" multiValued="true" />
    <field name="maindoc" type="string" stored="true" multiValued="true" />

    <!-- MCRFile related fields -->
    <field name="file_owner" type="string" indexed="true" stored="true" multiValued="false" />
    <field name="file_path" type="string" indexed="true" stored="true" multiValued="false" />
    <field name="file_name" type="string" indexed="true" stored="true" multiValued="false" />

    <field name="stream_name" type="string" indexed="true" stored="true" multiValued="false" />
    <field name="stream_size" type="string" indexed="true" stored="true" multiValued="false" />
    <field name="stream_content_type" type="string" indexed="true" stored="true" multiValued="false" />
    <field name="stream_source_info" type="string" indexed="true" stored="true" multiValued="false" />

    <!-- preview in search results -->
    <field name="search_result_link_text" type="string" stored="true" multiValued="true" />
    <field name="search_result_description" type="text_de" indexed="true" multiValued="true" stored="true" />

    <!-- person -->
    <field name="heading" type="text_de" indexed="true" stored="true" />
    <field name="alternative.name" type="text_de" indexed="true" stored="true" multiValued="true" />
    <field name="indexBrowsePerson" type="text_de" indexed="true" />
    <field name="indexBrowseCorporation" type="text_de" indexed="true" />
    <field name="placeOfActivity" type="text_de" indexed="true" stored="true" multiValued="true" />

    <field name="payload" type="payloads" indexed="true" />

    <!-- JPORTAL specific fields -->
    <field name="allMeta" type="text_de" index="true" stored="false" multiValued="true" />

    <field name="journalID" type="string" indexed="true" stored="true" />
    <field name="journalTitle" type="string" indexed="true" stored="true" />

    <field name="titles" type="text_de" index="true" stored="false" multiValued="true" />
    <field name="maintitle" type="string" index="true" stored="true" />
    <field name="maintitle_lowercase" type="lowercase" index="true" stored="false" />

    <field name="date" type="string" indexed="true" multiValued="true" />
    <field name="date.published" type="string" index="true" stored="true" />
    <field name="date.published_from" type="string" index="true" stored="true" />
    <field name="date.published_until" type="string" index="true" stored="true" />
    <field name="date.published_Original" type="string" index="false" stored="true" />
    <field name="date.published_Original_From" type="string" index="false" stored="true" />
    <field name="date.published_Original_Till" type="string" index="false" stored="true" />

    <!-- id#text -->
    <field name="publisher" type="string" index="false" stored="true" multiValued="true"/>

    <field name="participant" type="string" index="false" stored="true" />
    <field name="participantID" type="string" index="false" stored="true" />

    <field name="contentClassi1" type="string" index="true" stored="true" />
    <field name="contentClassi2" type="string" index="true" stored="true" />
    <field name="contentClassi3" type="string" index="true" stored="true" />
    <field name="contentClassi4" type="string" index="true" stored="true" />
    <field name="contentClassi5" type="string" index="true" stored="true" />
    <field name="contentClassi6" type="string" index="true" stored="true" />
    <field name="contentClassi7" type="string" index="true" stored="true" />

    <field name="keywords" type="text_de" index="true" multiValued="true" />

    <!-- volume & article -->
    <field name="position" type="string" index="true" stored="true" />
    <field name="size" type="string" index="false" stored="true" />
    <field name="rubric" type="string" index="false" stored="true" multiValued="true" />

    <!-- JPortal copy fields -->
    <copyField source="maintitle" dest="maintitle_lowercase" />

    <!-- copied fields -->
    <copyField source="unitid" dest="identifier" stored="true" multiValued="false" />
    <copyField source="unittitle" dest="title" />
    <copyField source="unittitle" dest="search_result_link_text" />
    <copyField source="title" dest="search_result_link_text" />
    <copyField source="heading" dest="search_result_link_text" />

    <field name="derCount" type="long" indexed="true" stored="true" />
    <copyField source="derivate.count" dest="derCount" />

    <field name="typeOfUnit" type="string" indexed="true" stored="true" multiValued="true" />
    <copyField source="cbuUnitTypes" dest="typeOfUnit" />

    <field name="servdate.type.createdate" type="date" indexed="true" stored="true" />
    <copyField source="servdate.type.createdate" dest="created" />

    <field name="servdate.type.modifydate" type="date" indexed="true" stored="true" />
    <copyField source="servdate.type.modifydate" dest="modified" />

  </fields>

  <uniqueKey>id</uniqueKey>

  <defaultSearchField>allMeta</defaultSearchField>

  <!-- SolrQueryParser configuration: defaultOperator="AND|OR" -->
  <solrQueryParser defaultOperator="OR" />
</schema>
